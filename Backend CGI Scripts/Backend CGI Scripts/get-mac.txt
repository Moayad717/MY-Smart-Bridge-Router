#!/bin/sh
# filepath: /www/cgi-bin/get-mac
echo "Content-type: text/plain"
echo ""

# Get client's MAC address from ARP table using their IP
CLIENT_IP=$(echo "$REMOTE_ADDR" | grep -oE '([0-9]{1,3}\.){3}[0-9]{1,3}')
MAC=$(arp -n | grep "$CLIENT_IP" | awk '{print $3}')

if [ -z "$MAC" ]; then
    echo "unknown"
else
    echo "$MAC"
fi